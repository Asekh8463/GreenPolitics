<!DOCTYPE html>
<html lang="en-UK">
<head>
<link rel="stylesheet" href="layout.css">
 <style>
  div.text {
    font-family: Arial;
    font-size: 20px;
    line-height: 36pt;
    color: #ffffff;
    display: inline-block;
}
  div.line {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}
   div.score {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    div.bar {
    height: 36pt;
    line-height: 36pt;
    padding: 8pt;
    margin-top: 4pt;
    margin-bottom: 4pt;
    border-width: 4px;
    border-right-width: 1px;
    border-top-style: solid;
    border-bottom-style: solid;
    border-color: #000000;
    background-color: #eeeeee;
    display: block;
    width: 50%;
}
    div.auth {
     background-color: #00008f;
}
    div.dece {
     background-color: #006ab8;
}    
  </style>
<title> GreenPolitics </title>
</head>
<body>
  <h1>GreenPolitics Results</h1><br>
  <p><b>Centralism</b></p>
 <div class="line">
<img id="img-auth" src="auth.png" height=128pt"/>
<div class="score auth" id="score-auth"><div class="text" id="centralized"></div></div>
<div class="score dece" id="score-dece"><div class="test" id="decentral"></div></div>
<img id="img-indy" src="indy.png" height=128pt"/>
 </div>
 <script>
    function getQueryVariable(variable)
    {
           var query = window.location.search.substring(1)
           var vars = query.split("&")
           for (var i=0;i<vars.length;i++) {
                   var pair = vars[i].split("=")
                   if(pair[0] == variable) {return pair[1]}
           }
           return(NaN);
    }

    function setScoreValue(name, value) {
        innerel = document.getElementById(name)
        outerel = document.getElementById("score-" + name)
        outerel.style.width = (value + "%")
        innerel.innerHTML = (value + "%")
        if (innerel.offsetWidth + 20 > outerel.offsetWidth) {
            innerel.style.visibility = "hidden"
        }
    }

    authArray = ["Very Centralized","Centralized","Partially Centralized","Balanced","Partially Decentralized","Decentralized","Very Decentralized"]
    radcArray = ["Revolutionary","Radical","Somewhat Radical","Neutral","Somewhat Reformist","Reformist","Institutionalist"]
    progArray = ["Very Progressive","Progressive","Slightly Progressive","Balanced","Slightly Regressive","Regressive","Primitivist"]
    anthArray = ["Strong Anthropocentrist","Anthropocentrist","Leaning Ecocentrist","Neutral","Leaning Ecocentrist","Ecocentrist","Strong Ecocentrist"]
	nihiArray = ["Cynicist","Pessimist","Realist","Balanced","Hopeful","Optimist","Very optimistic"]


    function setLabel(val,ary) {
        if (val > 90) { return ary[0] } else
        if (val > 75) { return ary[1] } else
        if (val > 60) { return ary[2] } else
        if (val >= 40) { return ary[3] } else
        if (val >= 25) { return ary[4] } else
        if (val >= 10) { return ary[5] } else
        if (val >= 0) { return ary[6] } else
        	{return ""}
    }

    centralized      = getQueryVariable("u")
    radical          = getQueryVariable("r")
    progressive      = getQueryVariable("p")
    anthropocentric  = getQueryVariable("a")
    pessimism        = getQueryVariable("n")
    decentral        = (100 - centralism      ).toFixed(1)
    reformist        = (100 - radical         ).toFixed(1)
    primitive        = (100 - progressive     ).toFixed(1)
    ecocentric       = (100 - anthropocentric ).toFixed(1)
    optimist         = (100 - pessimism        ).toFixed(1)


    setScoreValue("centralized", centralized)
    setScoreValue("decentral", decentral)
    setScoreValue("radical", radical)
    setScoreValue("reformism", reformism)
    setScoreValue("progressive", progressive)
    setScoreValue("primitive", primitive)
    setScoreValue("anthropocentric", anthropocentric)
    setScoreValue("ecocentric", ecocentric)
    setScoreValue("pessimism", pessimism)
    setScoreValue("optimist", optimist)



    document.getElementById("centralism-label").innerHTML = setLabel(centralism, authArray)
    document.getElementById("radicalism-label").innerHTML = setLabel(radical, radcArray)
    document.getElementById("techno-label").innerHTML = setLabel(progressive, progArray)
    document.getElementById("centric-label").innerHTML = setLabel(anthropocentric, anthArray)
    document.getElementById("hopes-label").innerHTML = setLabel(pessimism, nihiArray)


    ideology = ""
    ideodist = Infinity
    for (var i = 0; i < ideologies.length; i++) {
        dist = 0
        dist += Math.pow(Math.abs(ideologies[i].stats.radi - centralism), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.coop - radical), 1.5)
        dist += Math.pow(Math.abs(ideologies[i].stats.ownr - progressive), 1.75)
        dist += Math.pow(Math.abs(ideologies[i].stats.glob - anthropocentric), 1.5)
	dist += Math.pow(Math.abs(ideologies[i].stats.prog - pessimism), 1.5)

        if (dist < ideodist) {
            ideology = ideologies[i].name
            ideodist = dist
        }
    }
    document.getElementById("ideology-label").innerHTML = ideology

    function createImage(src, x, y, w, h) {
        img = new Image ()
        img.src = src
        img.onLoad = function() {
            ctx.drawImage(img, x, y, w, h)
        }
    }

    window.onload = function() {
            var c = document.createElement("canvas")
            var ctx = c.getContext("2d")
            c.width = 800;
            c.height = 700;
            ctx.fillStyle = "#E7DECC"
            ctx.fillRect(0,0,800,700);

            img = document.getElementById("img-auth")
            ctx.drawImage(img, 30, 150, 100, 100);
            img = document.getElementById("img-indy")
            ctx.drawImage(img, 770, 150, 100, 100)
            img = document.getElementById("img-radical")
            ctx.drawImage(img, 30, 270, 100, 100)
            img = document.getElementById("img-reform")
            ctx.drawImage(img, 770, 270, 100, 100)
            img = document.getElementById("img-progressive")
            ctx.drawImage(img, 30, 390, 100, 100)
            img = document.getElementById("img-prim")
            ctx.drawImage(img, 770, 390, 100, 100)
            img = document.getElementById("img-anthro")
            ctx.drawImage(img, 30, 510, 100, 100)
            img = document.getElementById("img-eco")
            ctx.drawImage(img, 770, 510, 100, 100)
            img = document.getElementById("img-pessimism")
            ctx.drawImage(img, 30, 630, 100, 100)
            img = document.getElementById("img-optimism")
            ctx.drawImage(img, 770, 630, 100, 100)

            ctx.fillStyle="#E7DECC"
            ctx.fillRect(120, 150, 560, 80)
            ctx.fillRect(120, 270, 560, 80)
            ctx.fillRect(120, 390, 560, 80)
            ctx.fillRect(120, 510, 560, 80)
            ctx.fillRect(120, 630, 560, 80)
            ctx.fillStyle="#0008f"
            ctx.fillRect(120, 184, 5.6*centralized-2, 72)
            ctx.fillStyle="#0285b3"
            ctx.fillRect(682-5.6*decentral, 184, 5.6*decentral-2, 72)
            ctx.fillStyle="#ff0000"
            ctx.fillRect(120, 304, 5.6*radical-2, 72)
            ctx.fillStyle="#ff86c1"
            ctx.fillRect(682-5.6*reformist, 304, 5.6*reformist-2, 72)
            ctx.fillStyle="#0000ff"
            ctx.fillRect(120, 424, 5.6*progressive-2, 72)
            ctx.fillStyle="#008800"
            ctx.fillRect(682-5.6*primitive, 424, 5.6*primitive-2, 72)
            ctx.fillStyle="#848484"
            ctx.fillRect(120, 544, 5.6*anthropocentric-2, 72)
            ctx.fillStyle="00ff00"
            ctx.fillRect(682-5.6*ecocentric, 544, 5.6*ecocentric-2, 72)
            ctx.fillStyle="#7b1f94"
            ctx.fillRect(120, 664, 5.6*pessimism-2, 72)
            ctx.fillStyle="#00b61a"
            ctx.fillRect(682-5.6*optimistic, 664, 5.6*optimistic-2, 72)
            ctx.fillStyle="#E7DECC"
            ctx.font="700 60px Arial"
            ctx.textAlign="left"
            ctx.fillText("GreenPolitics", 20, 90)
            ctx.font="50px Arial"
            ctx.fillText(ideology, 20, 140)

            ctx.textAlign="left"
            if (moderate       > 30) {ctx.fillText(moderate + "%", 130, 237.5)}
            if (leftunity      > 30) {ctx.fillText(leftunity + "%", 130, 357.5)}
            if (centralized    > 30) {ctx.fillText(centralized + "%", 130, 477.5)}
            if (localist       > 30) {ctx.fillText(localist + "%", 130, 597.5)}
            if (traditionalist > 30) {ctx.fillText(traditionalist + "%", 130, 717.5)}
            if (reform         > 30) {ctx.fillText(reform + "%", 130, 837.5)}
            if (markets        > 30) {ctx.fillText(markets + "%", 130, 957.5)}
            ctx.textAlign="right"
            if (radical        > 30) {ctx.fillText(radical + "%", 670, 237.5)}
            if (libunity       > 30) {ctx.fillText(libunity + "%", 670, 357.5)}
            if (decentralized  > 30) {ctx.fillText(decentralized + "%", 670, 477.5)}
            if (globalist      > 30) {ctx.fillText(globalist + "%", 670, 597.5)}
            if (progressive    > 30) {ctx.fillText(progressive + "%", 670, 717.5)}
            if (revolution     > 30) {ctx.fillText(revolution + "%", 670, 837.5)}
            if (planning       > 30) {ctx.fillText(planning + "%", 670, 957.5)}

            ctx.font="300 25px Arial"
            ctx.fillText("GreenValues", 780, 40)
	    	ctx.fillText(version, 780, 70)
            ctx.textAlign="center"
            ctx.fillText("Radicality Axis: " + document.getElementById("radicality-label").innerHTML, 400, 175)
            ctx.fillText("Co-operation Axis: " + document.getElementById("co-operation-label").innerHTML, 400, 295)
            ctx.fillText("Ownership Axis: " + document.getElementById("ownership-label").innerHTML, 400, 415)
            ctx.fillText("World Axis: " + document.getElementById("world-label").innerHTML, 400, 535)
            ctx.fillText("Culture Axis: " + document.getElementById("culture-label").innerHTML, 400, 655)
            ctx.fillText("Rebelliousness Axis: " + document.getElementById("rebelliousness-label").innerHTML, 400, 775)
            ctx.fillText("Markets Axis: " + document.getElementById("markets-label").innerHTML, 400, 895)

            document.getElementById("banner").src = c.toDataURL();
        }
    }    
    </script>
</body>
</html>
                                               

